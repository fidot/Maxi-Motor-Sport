/*!CK:4174479481!*//*1420439535,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["LP38P"]); }

__d("TimelinePageLoadParam",[],function(a,b,c,d,e,f){e.exports={REQUEST_PARAM_NAME:"tipld",LAST_RANKED_UNIT_TIME:"rt",REPORT_UNIT_COUNT:"rc",STORY_UNIT_COUNT:"sc",VISIBLE_UNIT_COUNT:"vc"};},null);
__d("ComposerXDatepickerIconReset",["CSS","cx"],function(a,b,c,d,e,f,g,h){function i(j){g.removeClass(j.element,"_4_na");g.removeClass(j.element,"_509o");}e.exports=i;},null);
__d("onViewportChanged",["EventListener","emptyFunction","getViewportDimensions","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j){var k=[],l=false,m=null,n,o;function p(){var aa=i.withoutScrollbars();return {top:0,bottom:aa.height,left:0,right:aa.width};}function q(aa,ba){var ca={transform:ba||h.thatReturnsArgument,callback:aa,needsUpdate:true};k.push(ca);x();s();return {remove:r.bind(null,ca),scheduleCheck:v.bind(null,ca)};}function r(aa){var ba=k.indexOf(aa);if(ba!==-1){k.splice(ba,1);if(k.length===0)t();}}function s(){if(!o){o=g.listen(window,'scroll',w);n=g.listen(window,'resize',u);}}function t(){if(o){o.remove();n.remove();o=n=null;}}function u(){m=null;w();}function v(aa){aa.needsUpdate=true;x();}function w(){k.map(function(aa){return aa.needsUpdate=true;});x();}function x(){if(!l){l=true;j(function(){l=false;z();});}}function y(aa){if(aa.needsUpdate){aa.needsUpdate=false;return true;}return false;}function z(){if(!m)m=p();var aa=k.filter(y),ba=aa.map(function(ca){return ca.transform.call(null,m);});aa.forEach(function(ca,da){return ca.callback.call(null,ba[da]);});}e.exports=q;},null);
__d("onRectIsWithinViewport",["onViewportChanged"],function(a,b,c,d,e,f,g){function h(j,k){return !(j.bottom<k.top||j.top>k.bottom||j.right<k.left||j.left>k.right);}function i(j,k){var l;function m(o){var p=j();return !!p&&h(p,o);}function n(o){if(l!==o){l=o;k(o);}}return g(n,m);}e.exports=i;},null);
__d("OnVisible.react",["React","getElementRect","onRectIsWithinViewport","onlyChild"],function(a,b,c,d,e,f,g,h,i,j){var k=g.createClass({displayName:"OnVisible",propTypes:{onVisible:g.PropTypes.func,onHidden:g.PropTypes.func,buffer:g.PropTypes.number},componentDidMount:function(){this._createListener();},componentDidUpdate:function(){this._createListener();},componentWillUnmount:function(){this._removeListener();},reset:function(){this._removeListener();this._createListener();},check:function(){if(this._listener)this._listener.scheduleCheck();},_measureElementRect:function(){if(!this.isMounted())return null;var l=this.props.buffer||0,m=h(this.getDOMNode());m.left-=l;m.right+=l;m.top-=l;m.bottom+=l;return m;},_createListener:function(){var l=this.getDOMNode();if(this._listener&&l!==this._element)this._removeListener();if(!this._listener){this._element=l;this._listener=i(this._measureElementRect,function(m){var n=m?this.props.onVisible:this.props.onHidden;n&&n();}.bind(this));}},_removeListener:function(){if(this._listener){this._listener.remove();this._listener=null;}},render:function(){return j(this.props.children);}});e.exports=k;},null);
__d("XEventImpressionLoggerAsyncControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/events\/{eventid}\/ajax\/impression\/",{eventid:{type:"Int",required:true},acontext:{type:"StringToStringMap",required:true}});},null);
__d("EventImpressionLogger.react",["Arbiter","React","OnVisible.react","DOMContainer.react","AsyncRequest","XEventImpressionLoggerAsyncControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=h.createClass({displayName:"EventImpressionLogger",propTypes:{child:h.PropTypes.object.isRequired,event_id:h.PropTypes.number.isRequired,action_context:h.PropTypes.object.isRequired,start_signal:h.PropTypes.string,stop_signal:h.PropTypes.string,check_signal:h.PropTypes.string},componentDidMount:function(){this._listening=!this.props.start_signal;if(this.props.start_signal)g.subscribe(this.props.start_signal,function(n,o){this._signalData=o;this._listening=true;if(this._signalData){this._logImpression();}else if(!this.logged){this.refs.onvisible.reset();this.refs.onvisible.check();}}.bind(this));if(this.props.stop_signal)g.subscribe(this.props.stop_signal,function(){this._signalData=null;this._listening=false;}.bind(this));if(this.props.check_signal)g.subscribe(this.props.check_signal,function(n,o){this._signalData=o;if(this._signalData){this._logImpression();}else if(!this.logged){this.refs.onvisible.reset();this.refs.onvisible.check();}}.bind(this));},_logImpression:function(){if(!this._listening)return;if(this.logged)return;if(!document.documentElement.contains(this.props.child))return;if(this._signalData&&this._signalData.rect){var n=this.props.child.getBoundingClientRect(),o=this._signalData.rect,p=0;if(this._signalData.scrollTop)p=this._signalData.scrollTop;if(o.left&&o.left>n.left)return;if(o.right&&o.right<n.right)return;if(o.top&&o.top>n.top-p)return;if(o.bottom&&o.bottom<n.bottom-p)return;}this.logged=true;var q=new l().setInt('eventid',this.props.event_id).setStringToStringMap('acontext',this.props.action_context).getURI();new k(q).send();},render:function(){return (h.createElement(i,{onVisible:this._logImpression,ref:"onvisible"},h.createElement(j,null,this.props.child)));}});e.exports=m;},null);
__d("TimelineCapsuleUtilities",["CSS"],function(a,b,c,d,e,f,g){var h={setFirstUnit:function(i){var j=true;for(var k=0;k<i.childNodes.length;++k){var l=i.childNodes[k];if(l.id.indexOf('tl_unit_')===0)if(j){j=false;g.addClass(l,'firstUnit');}else{g.removeClass(l,'firstUnit');break;}}}};e.exports=h;},null);
__d("TimelineComposer",["Arbiter","Bootloader","ComposerXMarauderLogger","ComposerXStore","CSS","DOM","Parent","Run","TimelineCapsule","TimelineCapsuleUtilities","$","getObjectValues","goURI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t;function u(){i.logCompleted(t.id);}function v(x){if(x.hidePost){u();return;}if(x.redirect){var y=j.getAllForComposer(t.id);r(y).forEach(function(aa){if(aa.reset)aa.reset(aa);});s(x.redirect);u();return;}if(!x.streamStory){window.location.reload();return;}if(x.backdatedTime){h.loadModules(["TimelineStoryPublisher"],function(aa){aa.publish(x);});u();return;}var z=w.renderCapsuleBasedStory(t,x.streamStory);g.inform('TimelineComposer/on_after_publish',z,g.BEHAVIOR_PERSISTENT);u();}var w={init:function(x){t=q(x);var y=g.subscribe('composer/publish',function(event,z){if(z.composer_id===t.id)v(z);});n.onLeave(y.unsubscribe.bind(y));},renderCapsuleBasedStory:function(x,y){var z=m.byClass(x,'fbTimelineCapsule');if(!z)return;var aa=m.byClass(x,'fbTimelineUnit'),ba=aa.nextSibling;if(ba&&ba.getAttribute('data-spine'))aa=aa.nextSibling;l.insertAfter(aa,y);var ca=y;if(k.hasClass(y,'fbTimelineUnit'))ca=l.find(y,'div.timelineUnitContainer');h.loadModules(["Animation"],function(da){new da(ca).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(da.ease.both).go();});p.setFirstUnit(z);o.balanceCapsule(z);return y;}};e.exports=a.TimelineComposer||w;},null);
__d("TimelineUnitSelector",["DOMQuery","csx"],function(a,b,c,d,e,f,g,h){var i={getUnitsWithTime:function(j){return g.scry(j,"._5jmm[data-time]");}};e.exports=i;},null);
__d("TimelineComposerUtilities",["Event","Arbiter","Bootloader","CSS","DOM","DOMQuery","Parent","TimelineUnitSelector","Vector","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=86400*31,r=86400000,s={listenToSetEstimatedDate:function(t,u){return h.subscribe('ComposerXTimelineTagger/init',function(v,w){if(l.contains(t,w.datePickerElement)){s.setEstimatedDate(w.datePickerInstance,u());w.composerTimelineTagger.switchToTagger('date');}});},listenToPublish:function(t,u){if(t.root)t=t.root;return h.subscribe('composer/publish',function(event,v){if(v.composer_id===t.id)i.loadModules(["TimelineStoryPublisher"],function(w){w.publish(v);u&&u();});});},listenToAnotherComposerOpen:function(t,u){return h.subscribe('composer/mutate',function(v,w){if(w!==t)u();});},listenToCancel:function(t,u){return g.listen(t,'click',function(event){if(m.byClass(event.getTarget(),"_306"))u();});},setEstimatedDate:function(t,u){var v,w;if(u&&j.hasClass(u,'fbTimelineCapsule')){v=u.getAttribute('data-start');w=u.getAttribute('data-end');if(v&&w){var x=new Date(w*1000),y=new Date();if(x>y){t.setDate(y.getFullYear(),y.getMonth()+1,y.getDate());}else if(w-v>2*q){t.setDate(x.getFullYear());}else t.setDate(x.getFullYear(),x.getMonth()+1);}return;}var z=m.byClass(u,'fbTimelineCapsule');if(z){v=z.getAttribute('data-start');w=z.getAttribute('data-end');var aa=o.getElementPosition(u).y,ba=[w,null],ca=[v,null],da=n.getUnitsWithTime(z);for(var ea=0;ea<da.length;ea++){var fa=da[ea],ga=k.scry(fa.parentNode,'.spinePointer')[0];if(!ga)continue;var ha=o.getElementPosition(ga).y;if(ha<=aa){if(!ba[1]||ha>ba[1])ba=[fa.getAttribute('data-time'),ha];}else if(!ca[1]||ha<ca[1])ca=[fa.getAttribute('data-time'),ha];}if(ba[0]!==null&&ca[0]!==null){var ia=Math.round((parseInt(ba[0],10)+parseInt(ca[0],10))/2)*1000;ia=Math.min(new Date()-r,ia);t.setDateWithTimestamp(ia);}}}};e.exports=s;},null);
__d("TimelineSectionStore",["TimelinePageLoadParam","KeyedCallbackManager"],function(a,b,c,d,e,f,g,h){var i=new h(),j='num_reports_tried',k='num_reports_visible',l='more_pager_data',m={getDataToLoadNextSegment:function(n,o){i.executeOrEnqueue(n,function(p){this._mergeReportsAndStoriesDataCallback(p,o);}.bind(this));},setReportsData:function(n,o,p){var q=i.getResource(n);if(!q)q={};q[j]=o;q[k]=p;i.setResource(n,q);},setStoriesData:function(n,o){var p=i.getResource(n);if(!p)p={};p[l]=o;i.setResource(n,p);},_mergeReportsAndStoriesDataCallback:function(n,o){var p=n[l];if(!p.hasOwnProperty(g.REQUEST_PARAM_NAME))p[g.REQUEST_PARAM_NAME]={};p[g.REQUEST_PARAM_NAME][g.REPORT_UNIT_COUNT]=n[j];var q=p[g.REQUEST_PARAM_NAME][g.VISIBLE_UNIT_COUNT];p[g.REQUEST_PARAM_NAME][g.VISIBLE_UNIT_COUNT]=q+n[k];o(p);}};e.exports=m;},null);
__d("TimelineParallelColumnPager.react",["Link.react","React","TimelineSectionStore","UIPagelet","LoadingIndicator.react","OnVisible.react"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=h.PropTypes,n={},o={STATE_WAITING_FOR_ONVISIBLE:'state_waiting_for_onvisible',STATE_LOADING_INDICATOR:'state_loading_indicator',STATE_LINKIFIED:'state_linkified'},p=h.createClass({displayName:"TimelineParallelColumnPager",propTypes:{loadMoreLabel:m.string.isRequired,sectionKey:m.string.isRequired,rootID:m.string.isRequired},componentWillMount:function(){n[this.props.sectionKey]=this;},getInitialState:function(){return {pagerState:o.STATE_WAITING_FOR_ONVISIBLE};},render:function(){if(this.state.pagerState===o.STATE_LOADING_INDICATOR)return h.createElement(k,{size:"small",color:"white"});if(this.state.pagerState===o.STATE_LINKIFIED)return (h.createElement(g,{onClick:this._loadNextSegment},this.props.loadMoreLabel));return (h.createElement(l,{onVisible:this._loadNextSegment},h.createElement("div",null)));},statics:{getInstance:function(q){return n[q];}},removeOnVisible:function(){this.setState({pagerState:o.STATE_LINKIFIED});},_loadNextSegment:function(){this.setState({pagerState:o.STATE_LOADING_INDICATOR});i.getDataToLoadNextSegment(this.props.sectionKey,this._nextSegmentDataHandler);},_nextSegmentDataHandler:function(q){var r={usePipe:true,jsNonblock:true,buffer:1000,constHeight:true,target_id:q.unit_container_id,crossPage:true};j.loadFromEndpoint('ProfileTimelineSectionPagelet',this.props.rootID,q,r);}});e.exports=p;},null);
__d("TimelineContentLoader",["Arbiter","CSS","DOM","DOMScroll","Event","OnVisible","Parent","ScrollingPager","TimelineComponentKeys","TimelineConstants","TimelineController","TimelineLegacySections","TimelineParallelColumnPager.react","TimelineSmartInsert","UIPagelet","Vector","$","arrayContains","copyProperties","createArrayFromMixed","csx","debounce","ge","getElementText","fbt","userAction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){var ga=false,ha,ia=null,ja={},ka=[],la={},ma=[],na={},oa={},pa={},qa={},ra=null,sa=false,ta=null;function ua(db,eb,fb,gb,hb){"use strict";this.node=db;this.loaded=gb;this.canScrollLoad=true;this.canUnload=eb!=cb.RECENT;this.scrubberKey=eb;this.historicUnitCount=hb;this._pageletLoadData=fb;this._expandPageletLoadData={};this.rightColumnFinished=false;}ua.prototype.load=function(db,eb){"use strict";if(this.loaded)return;var fb=this._pageletLoadData;g.inform(p.SECTION_LOADING,{data:fb,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var gb='ProfileTimelineSectionPagelet',hb=this.scrubberKey==cb.WAY_BACK;if(hb)gb='ProfileTimelineRemainingYearsPagelet';fb.highlight_unit_data=db;fb.parent_key=this.parentKey;fb.force_no_friend_activity=sa;h.addClass(this.node,'fbTimelineSectionLoading');this.canScrollLoad=false;var ib=null;if(eb){this.node.style.minHeight=window.innerHeight+'px';ib=function(){this.node.style.minHeight='';za(this.scrubberKey);}.bind(this);}pa[this.scrubberKey]=u.loadFromEndpoint(gb,this.node.id,fb,{usePipe:true,jsNonblock:true,constHeight:true,append:false,finallyHandler:ib});ab();};ua.prototype.preload=function(){"use strict";h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var db=i.find(this.node,'span.sectionLabel');if(db.getAttribute('data-original-label')){i.setContent(db,db.getAttribute('data-original-label'));db.removeAttribute('data-original-label');}};ua.prototype.unload=function(){"use strict";if(!this.loaded||!this.canUnload)return;this.loaded=false;pa[this.scrubberKey]&&pa[this.scrubberKey].cancel();h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();};ua.prototype.activateScrollLoad=function(){"use strict";this.canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');oa[this.scrubberKey]&&oa[this.scrubberKey].reset();};ua.prototype.deactivateScrollLoad=function(){"use strict";if(!this.loaded){this.canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');oa[this.scrubberKey]&&oa[this.scrubberKey].remove();}};ua.prototype.setExpandLoadData=function(db){"use strict";this._expandPageletLoadData=db;return this;};ua.prototype.appendData=function(db){"use strict";y(this._pageleLoadData,db);return this;};ua.prototype.expandSubSections=function(){"use strict";if(this.subSections.length)cb.navigateToSection(this.subSections[0].scrubberKey);};ua.prototype.expand=function(db){"use strict";if(!this.loaded)return;ra.add_event('expand_'+this.scrubberKey);var eb=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(eb.firstChild,'async_saving');db&&h.addClass(db,'async_saving');cb.navigateToSection(this.scrubberKey);i.scry(this.node,'.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;pa[this.scrubberKey]&&pa[this.scrubberKey].cancel();pa[this.scrubberKey]=u.loadFromEndpoint('ProfileTimelineSectionPagelet',eb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});};ua.prototype.isPermalinkPeriod=function(){"use strict";return this._pageletLoadData.is_permalink_period;};function va(){if(ga)return;q.register(o.CONTENT,cb);ra=fa('timeline').uai('init','scrubber',false);ga=true;}var wa=ba(function(db,eb,fb){var gb=r.get(db).historicUnitCount;eb-=gb;fb-=1;if(gb==-1||fb<=0||eb<0)return;var hb=cb.getNextSectionKey(db);if(hb){r.get(hb).load();wa(hb,eb,fb);}},500);function xa(db,eb,fb,gb){var hb=cb.getNextSectionKey(eb);if(hb){oa[hb]=new l(db,ya.bind(null,hb),false,fb||1000);}else if(eb!==cb.WAY_BACK){gb=gb?gb:0;if(gb>80)return null;setTimeout(xa.bind(null,db,eb,fb,gb+1),250);}}function ya(db){var eb=r.get(db);if(eb&&eb.canScrollLoad){ra.add_event("scroll_load_"+db);eb.load();if(ta)wa(db,ta.required_units,ta.max_parallelism);}}function za(db){var eb=oa[db];if(eb){eb.remove();oa[db]=null;i.remove(eb.getElement());}}function ab(){var db,eb,fb=false;for(var gb=0;gb<ka.length;gb++){var hb=ka[gb];if(!hb)continue;var ib=r.get(hb);if(ib&&(ib.canScrollLoad||ib.loaded)){if(!ib.loaded){h.removeClass(ib.node,'fbTimelineTimePeriodSuppressed');h.addClass(ib.node,'fbTimelineTimePeriodUnexpanded');}if(db&&eb){bb(db,eb);if(fb)db.deactivateScrollLoad();fb=true;}db=null;eb=null;continue;}else if(db){eb=ib;ib.deactivateScrollLoad();}else{db=ib;if(fb)ib.activateScrollLoad();}h.removeClass(ib.node,'fbTimelineTimePeriodSuppressed');h.addClass(ib.node,'fbTimelineTimePeriodUnexpanded');}}function bb(db,eb){h.removeClass(eb.node,'fbTimelineTimePeriodUnexpanded');h.addClass(eb.node,'fbTimelineTimePeriodSuppressed');var fb=i.find(db.node,'span.sectionLabel'),gb=i.find(eb.node,'span.sectionLabel');if(!gb.getAttribute('data-original-label'))gb.setAttribute('data-original-label',da(gb));if(fb.getAttribute('data-month')&&gb.getAttribute('data-month')&&fb.getAttribute('data-year')==gb.getAttribute('data-year')){i.setContent(gb,ea._("Show {month1} - {month2} {year}",[ea.param("month1",gb.getAttribute('data-month')),ea.param("month2",fb.getAttribute('data-month')),ea.param("year",fb.getAttribute('data-year'))]));}else if(fb.getAttribute('data-year')!==gb.getAttribute('data-year')){i.setContent(gb,ea._("Show {year1} - {year2}",[ea.param("year1",gb.getAttribute('data-year')),ea.param("year2",fb.getAttribute('data-year'))]));}else i.setContent(gb,ea._("Show {year}",[ea.param("year",gb.getAttribute('data-year'))]));}var cb={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,FOOTER_HEIGHT:60,registerTimePeriod:function(db,eb,fb,gb,hb,ib,jb){va();if(x(ma,eb))return;if(la)y(fb,la);var kb=new ua(db,eb,fb,gb,jb);if(!hb){ka[ib]=eb;ja[eb]=true;}else{kb.parentKey=hb;r.get(hb).subSections=r.get(hb).subSections||[];r.get(hb).subSections[ib]=kb;}r.set(eb,kb);cb.checkCurrentSectionChange();g.inform(p.SECTION_REGISTERED,{scrubberKey:eb,period:kb});},reset:function(){for(var db in oa)oa[db]&&oa[db].remove();for(var eb in pa)pa[eb]&&pa[eb].cancel();for(var fb in qa){qa[fb].unsubscribe();delete qa[fb];}ha&&ha.unsubscribe();ha=null;r.removeAll();ia=null;ja={};ka=[];la={};ma=[];na={};oa={};pa={};ra=null;sa=false;ga=false;},checkCurrentSectionChange:function(){var db=cb.getCurrentSection(),eb=ia&&ia.scrubberKey;if(db&&db.scrubberKey!==eb&&!db.isPermalinkPeriod()){ia=db;var fb=db.scrubberKey,gb=db.parentKey;if(!gb){gb=fb;fb=null;}q.sectionHasChanged(gb,fb);}},setParallelLoadConfig:function(db){ta=db;},getCurrentSection:function(){var db={},eb=r.getAll();for(var fb in eb){var gb=eb[fb];if(!gb.loaded||na[gb.scrubberKey])continue;var hb=v.getElementPosition(gb.node,'viewport').y;if(gb.scrubberKey=='recent')hb--;if(hb<cb.CURRENT_SECTION_OFFSET)db[hb]=gb;}var ib=Math.max.apply(null,Object.keys(db)),jb=ib==-Infinity;if(!jb){return db[ib];}else if(ka[0])return r.get(ka[0]);return null;},capsuleForCurrentSection:function(){var db=cb.getCurrentSection();return db&&i.scry(db.node,'.fbTimelineCapsule')[0];},enableScrollLoad:function(db,eb,fb,gb){db=w(db);var hb=m.byClass(db,'fbTimelineSection')||db.parentNode,ib=hb&&i.scry(hb,'.fbTimelineCapsule')[0];if(!ib)return;if(fb===null){xa(db,eb,gb);}else q.runOnceWhenSectionFullyLoaded(xa.bind(null,db,eb,gb),eb,fb);},expandSectionOnClick:function(db,eb){k.listen(db,'click',function(fb){fb.prevent();r.get(eb).expand();});},expandSubSectionsOnClick:function(db,eb){k.listen(db,'click',function(fb){fb.prevent();r.get(eb).expandSubSections();});},getNextSectionKey:function(db){for(var eb=0;eb<ka.length-1;eb++)if(ka[eb]==db){while(eb<ka.length-1&&!ka[eb+1])eb++;return ka[eb+1];}var fb=r.get(db);if(!fb||!fb.parentKey)return;var gb=r.get(fb.parentKey);if(!gb)return;for(var hb=0;hb<gb.subSections.length-1;hb++)if(gb.subSections[hb].scrubberKey==db)return gb.subSections[hb+1].scrubberKey;},hideSection:function(db){var eb=r.get(db);eb&&h.hide(i.find(eb.node,'.fbTimelineSection'));var fb=q.getCurrentScrubber();if(fb){var gb=null;if(!ja[db]){var hb=eb.parentKey;gb=q.getCurrentScrubber().getSubnav(hb,db);}else gb=q.getCurrentScrubber().getNav(db);gb&&h.hide(gb);}var ib=q.getCurrentStickyHeaderNav();ib&&ib.removeTimePeriod(db);na[db]=true;},loadSectionOnClick:function(db,eb){k.listen(db,'click',function(fb){fb.prevent();r.get(eb).load();});},removeSection:function(db){for(var eb in ka)if(ka[eb]==db){ka[eb]=null;break;}r.remove(db);delete ja[db];if(db in oa){oa[db].remove();delete oa[db];}var fb=q.getCurrentStickyHeaderNav();fb&&fb.removeTimePeriod(db);ma.push(db);},removeSectionParent:function(db){i.remove(w(db).parentNode);},navigateToSection:function(db,eb,fb){ra.add_event("nav_"+db);eb=!!eb;var gb=db,hb=r.get(db);if(!hb)return;if(!hb.loaded){t.enable();i.scry(w('timeline_tab_content'),'.fbTimelineShowOlderSections').forEach(i.remove);}if(!ja[db]){if(!hb.loaded)hb.node.style.minHeight=v.getViewportDimensions().y+'px';var ib=g.subscribe(p.SECTION_FULLY_LOADED,function(qb,rb){if(rb.scrubberKey===db){hb.node.style.minHeight='';ib.unsubscribe();}});gb=hb.parentKey;var jb=r.get(gb).node;if(!h.hasClass(jb,'fbTimelineSectionExpanded')){j.scrollTo(jb,0);h.addClass(jb,'fbTimelineSectionExpanded');i.scry(jb,'.fbTimelineCapsule').forEach(i.remove);i.scry(jb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(jb,'div.fbTimelineContentHeader').forEach(i.remove);i.scry(jb,"._5vf").forEach(function(qb){if(!qb.getAttribute('data-subsection'))i.remove(qb);});}var kb=cb.getNextSectionKey(gb);if(kb&&oa[kb])oa[kb].setBuffer(0);}for(var lb=0;lb<ka.length;lb++){var mb=ka[lb];if(!mb)continue;if(mb==gb)break;r.get(mb).deactivateScrollLoad();i.scry(w('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(qb){var rb=n.getInstance(qb.id);rb&&rb.removeOnVisible();});var nb=s.getInstance(mb);nb&&nb.removeOnVisible();}hb.load(fb,true);ab();var ob=v.getScrollPosition().x,pb=v.getElementPosition(hb.node).y;if(!eb)j.scrollTo(new v(ob,pb-p.SCROLL_TO_OFFSET,'document'),true,false,false,0,function(){var qb=v.getElementPosition(hb.node).y;j.scrollTo(new v(ob,qb-p.SCROLL_TO_OFFSET,'document'),false);var rb=i.scry(hb.node,'h3.uiHeaderTitle')[0];if(rb){rb.tabIndex=0;rb.focus();}});},appendContentAfterLoad:function(db,eb,fb){q.runOnceWhenSectionFullyLoaded(i.appendContent.bind(null,w(db),eb),fb,'0');},markSectionAsLoaded:function(db,eb,fb){q.runOnceWhenSectionFullyLoaded(function(){ca(db)&&h.removeClass(w(db).parentNode,'fbTimelineSectionLoading');},eb,fb);},suppressSectionsAbove:function(db){var eb,fb;for(var gb=0;gb<ka.length;gb++){var hb=ka[gb];if(!hb)continue;eb=r.get(hb).node;fb=null;if(z(db.parentNode.children).indexOf(db)<=z(eb.parentNode.children).indexOf(eb)){fb=hb;break;}r.get(hb).deactivateScrollLoad();}if(fb)cb.navigateToSection(fb,true);},forceNoFriendActivity:function(){sa=true;},removeDupes:function(db){var eb=ca(db);if(!eb)return;var fb=i.scry(eb,'li.fbTimelineUnit'),gb={};for(var hb=0;hb<fb.length;hb++){var ib=fb[hb];if(ib.id&&ib.id.startsWith('tl_unit_')){var jb=ib.id.substring(8,ib.id.length),kb=i.scry(ib,'div.timelineUnitContainer');if(kb.length>0)jb=jb+kb[0].getAttribute('data-time');if(gb.hasOwnProperty(jb)){ib.id='dupe_unit_'+Math.random();ib.className="hidden_elem";}else gb[jb]=1;}}},removeLoadingState:function(db){ca(db)&&h.removeClass(w(db),'fbTimelineSectionLoading');},setExpandLoadDataForSection:function(db,eb){var fb=r.get(db);fb&&fb.setExpandLoadData(eb);},appendSectionDataForAllSections:function(db){la=db;for(var eb=0;eb<ka.length-1;eb++){var fb=ka[eb];if(!fb)continue;var gb=r.get(fb);gb&&gb.appendData(db);}},updatePagerAfterLoad:function(db,eb,fb,gb,hb){var ib=n.getInstance(db.firstChild.id);if(!ib){qa[db.firstChild.id]=g.subscribe(n.REGISTERED,function(jb,kb){qa[db.firstChild.id].unsubscribe();delete qa[db.firstChild.id];if(kb.id===db.firstChild.id)cb.updatePagerAfterLoad(db,eb,fb,gb,hb);});return;}q.runOnceWhenSectionFullyLoaded(function(){h.removeClass(db,'fbTimelineHiddenPager');ib.checkBuffer();},fb,gb);if(hb)q.runOnceWhenSectionFullyLoaded(q.adjustScrollingPagerBuffer.bind(null,db.firstChild.id,eb),fb,gb);},repositionDialog:function(db){g.subscribe(p.SECTION_LOADED,function(){db.updatePosition();});},rightColumnFinished:function(db){var eb=r.get(db);eb.rightColumnFinished=true;},addUnrankedUnits:function(db){var eb=w(db),fb=i.scry(eb,'li.fbTimelineUnit');for(var gb=fb.length-1;gb>=0;gb--){var hb=fb[gb];i.insertAfter(eb,hb);h.addClass(i.find(hb,'div.timelineUnitContainer'),'fbTimelineHighlightUnit');}i.remove(eb);},addUnrankedStories:function(db){var eb=w(db),fb=i.scry(eb,"._5pat");for(var gb=fb.length-1;gb>=0;gb--){var hb=fb[gb];i.insertAfter(eb,hb);}i.remove(eb);}};e.exports=cb;},null);
__d("TimelineLogging",["TimelineComponentKeys","TimelineController","reportData"],function(a,b,c,d,e,f,g,h,i){var j=false,k=0,l=null,m=null,n={init:function(o){if(j)return;k=o;h.register(g.LOGGING,this);},reset:function(){j=false;k=0;l=null;},log:function(o,p){p.profile_id=k;i(o,{gt:p});},logSectionChange:function(o,p){var q={timeline_section_change:1,key:o};if(l&&o==l){q.timeline_scrubber=1;l=null;}if(m&&o==m){q.sticky_header_nav=1;m=null;}n.log('timeline',q);},logScrubberClick:function(o){l=o;},logStickyHeaderNavClick:function(o){m=o;}};e.exports=n;},null);
__d("TimelineSpinelessComposer",["Arbiter","Bootloader","ComposerXMarauderLogger","Run","TimelineComposer","TimelineComposerUtilities"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m;function n(){i.logCompleted(m.id);}function o(q){if(q.hidePost){n();return;}if(!q.streamStory){window.location.reload();return;}if(q.backdatedTime){h.loadModules(["TimelineStoryPublisher"],function(r){r.publish(q);});n();return;}k.renderCapsuleBasedStory(m,q.streamStory);n();}var p={init:function(q){m=q;var r=g.subscribe('composer/publish',function(event,s){if(s.composer_id===m.id)o(s);});j.onLeave(r.unsubscribe.bind(r));}};e.exports=p;},null);
__d("TimelineStickyRightColumn",["Arbiter","CSS","DOMQuery","Event","PhotoSnowlift","Run","Style","TimelineContentLoader","Vector","csx","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=100,s=15,t=15,u=35,v=false,w=null,x=null,y,z,aa,ba,ca,da,ea,fa;function ga(){if(k.getInstance().isOpen)return;y=n.getCurrentSection();if(!y||!y.rightColumnFinished)return;var oa=i.scry(y.node,"._3rbf")[0],pa=i.scry(y.node,"._3rbh")[0];z=oa?oa.offsetHeight:0;aa=pa?pa.offsetHeight:0;ba=o.getViewportDimensions().y;ea=oa?o.getElementPosition(oa).y:0;fa=document.body.clientWidth<document.body.scrollWidth;}function ha(){if(!y||k.getInstance().isOpen)return;if(x&&x!==y){var oa=i.scry(x.node,"._3rbh")[0];if(oa)ja(oa,'','','');}var pa=i.scry(y.node,"._3rbh")[0];if(!pa)return;if(fa){ja(pa,'','','');return;}if(!y||!y.rightColumnFinished)return;ia(y);x=h.hasClass(pa,'fixed_always')?y:null;}function ia(oa){if(aa>=z||z<=ba)return;da=ca;ca=o.getScrollPosition().y;var pa,qa=i.scry(oa.node,"._3rbh")[0];if(!qa)return;if(ca<=ea-ka()){ja(qa,'','','');return;}if(z+ea<=ca+Math.min(aa+ka(),ba-t-u)){ja(qa,'absolute','',t+'px');return;}if(aa>ba-t-ka()){if(ca<da){var ra=false;if(qa.style.position==='absolute')if(qa.style.top!==''&&ca+ka()-ea<=parseInt(qa.style.top,10)){ra=true;}else if(qa.style.bottom!==''&&ca<=(ea+z-ka())-aa)ra=true;if(ra){ja(qa,'fixed',ka()+'px','');return;}else if(qa.style.position==='absolute'&&qa.style.top){return;}else if(h.hasClass(qa,'fixed_always')){if(parseInt(qa.style.top,10)>=ka())return;pa=ca-ea-(aa-(ba-u));if(da)pa+=da-ca;ja(qa,'absolute',pa+'px','');return;}}else{var sa=false;if(qa.style.position==='absolute'||(qa.style.position===''&&!h.hasClass(qa,'fixed_always'))){pa=qa.style.top?parseInt(qa.style.top,10):0;if(ca+ba>=ea+pa+aa+u)sa=true;}if(sa){pa=ba-aa-t-u;ja(qa,'fixed',pa+'px','');return;}else if(ca==da){return;}else if(h.hasClass(qa,'fixed_always')){if(parseInt(qa.style.top,10)>=ka()){pa=ca-ea+ka();if(da)pa+=da-ca;ja(qa,'absolute',pa+'px','');return;}}else if(qa.style.position==='absolute')return;}}else ja(qa,'fixed',ka()+'px','');}function ja(oa,pa,qa,ra){m.set(oa,'bottom',ra);if(pa==='fixed'){h.addClass(oa,'fixed_always');m.set(oa,'position','');}else{h.removeClass(oa,'fixed_always');m.set(oa,'position',pa);}m.set(oa,'top',qa);g.inform('reflow');}function ka(){return h.hasClass(document.documentElement,'tinyViewport')?s:r;}function la(){q(ga,ha);}function ma(){v=false;x=null;while(w.length)w.pop().remove();w=null;}var na={init:function(){if(v)return;v=true;w=[j.listen(window,'scroll',la),j.listen(window,'resize',la)];l.onLeave(ma);},adjust:function(){if(v){ga();ha();}}};e.exports=na;},null);